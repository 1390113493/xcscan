import{o as e,c as t,w as s,b as i,t as a,n,m as l,e as r,i as o,a as u,j as d,h as c,r as p,s as m,x as g,d as f,f as y,y as _}from"./index.181fe990.js";import{_ as h,b,s as k,g as S,r as C,d as x,a as T,c as v}from"./storage.c59ed215.js";import{_ as w}from"./uni-card.058dd26d.js";import{_ as U}from"./uni-easyinput.48f9ef63.js";import"./md5.5401987c.js";import"./uni-icons.8df73d30.js";var $=h({name:"UniTag",emits:["click"],props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},text:{type:String,default:""},disabled:{type:[Boolean,String],default:!1},inverted:{type:[Boolean,String],default:!1},circle:{type:[Boolean,String],default:!1},mark:{type:[Boolean,String],default:!1},customStyle:{type:String,default:""}},computed:{classes(){const{type:e,disabled:t,inverted:s,circle:i,mark:a,size:n,isTrue:l}=this;return["uni-tag--"+e,"uni-tag--"+n,l(t)?"uni-tag--disabled":"",l(s)?"uni-tag--"+e+"--inverted":"",l(i)?"uni-tag--circle":"",l(a)?"uni-tag--mark":"",l(s)?"uni-tag--inverted uni-tag-text--"+e:"","small"===n?"uni-tag-text--small":""].join(" ")}},methods:{isTrue:e=>!0===e||"true"===e,onClick(){this.isTrue(this.disabled)||this.$emit("click")}}},[["render",function(u,d,c,p,m,g){const f=o;return c.text?(e(),t(f,{key:0,class:n(["uni-tag",g.classes]),style:l(c.customStyle),onClick:g.onClick},{default:s((()=>[i(a(c.text),1)])),_:1},8,["class","style","onClick"])):r("",!0)}],["__scopeId","data-v-7a888830"]]);var F=h({name:"UniSection",emits:["click"],props:{type:{type:String,default:""},title:{type:String,required:!0,default:""},titleFontSize:{type:String,default:"14px"},titleColor:{type:String,default:"#333"},subTitle:{type:String,default:""},subTitleFontSize:{type:String,default:"12px"},subTitleColor:{type:String,default:"#999"},padding:{type:[Boolean,String],default:!1}},computed:{_padding(){return"string"==typeof this.padding?this.padding:this.padding?"10px":""}},watch:{title(e){uni.report&&""!==e&&uni.report("title",e)}},methods:{onClick(){this.$emit("click")}}},[["render",function(p,m,g,f,y,_){const h=c,b=o;return e(),t(h,{class:"uni-section"},{default:s((()=>[u(h,{class:"uni-section-header",onClick:_.onClick},{default:s((()=>[g.type?(e(),t(h,{key:0,class:n(["uni-section-header__decoration",g.type])},null,8,["class"])):d(p.$slots,"decoration",{key:1},void 0,!0),u(h,{class:"uni-section-header__content"},{default:s((()=>[u(b,{style:l({"font-size":g.titleFontSize,color:g.titleColor}),class:n(["uni-section__content-title",{distraction:!g.subTitle}])},{default:s((()=>[i(a(g.title),1)])),_:1},8,["style","class"]),g.subTitle?(e(),t(b,{key:0,style:l({"font-size":g.subTitleFontSize,color:g.subTitleColor}),class:"uni-section-header__content-sub"},{default:s((()=>[i(a(g.subTitle),1)])),_:1},8,["style"])):r("",!0)])),_:1}),u(h,{class:"uni-section-header__slot-right"},{default:s((()=>[d(p.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["onClick"]),u(h,{class:"uni-section-content",style:l({padding:_._padding})},{default:s((()=>[d(p.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3})}],["__scopeId","data-v-42b13ba1"]]);var j=h({data:()=>({username:"",inputUsernme:"",message:"",styles:{color:"#2979FF",borderColor:"#2979FF"}}),methods:{login(){if(this.inputUsernme.length<9||this.inputUsernme.length>11)return this.message="请注意输入格式!",void this.$refs.warn.open("top");p({url:b+"login",data:{username:this.inputUsernme},method:"POST",success:e=>{let t=e.data.msg;this.message=t,0==e.data.code?(k("username",this.inputUsernme),this.$refs.success.open("top"),setTimeout((function(){m({url:"/pages/index/index"})}),2e3)):this.$refs.error.open("top")},fail:()=>{this.message="身份绑定失败，请重试！\n如果多次失败，请联系学工办管理人员！",this.$refs.error.open("top")}})},logout(){k("username",""),this.message="取消绑定信息成功",this.$refs.success.open("top"),setTimeout((function(){location.reload()}),2e3)},toList(){g({url:"/pages/list/list"})}},onShow(){this.username=S("username")}},[["render",function(a,n,l,r,d,p){const m=C(y("uni-popup-message"),x),g=C(y("uni-popup"),T),h=_,b=C(y("uni-card"),w),k=c,S=C(y("uni-tag"),$),j=o,z=C(y("uni-easyinput"),U),B=C(y("uni-section"),F),V=C(y("copyright"),v);return e(),t(k,null,{default:s((()=>[u(g,{ref:"warn",type:"message"},{default:s((()=>[u(m,{type:"warn",message:d.message,duration:2e3},null,8,["message"])])),_:1},512),u(g,{ref:"success",type:"message"},{default:s((()=>[u(m,{type:"success",message:d.message,duration:2e3},null,8,["message"])])),_:1},512),u(g,{ref:"error",type:"message"},{default:s((()=>[u(m,{type:"error",message:d.message,duration:3e3},null,8,["message"])])),_:1},512),d.username?(e(),t(k,{key:0},{default:s((()=>[u(b,{title:d.username,isFull:!0,"sub-title":"您好!"},{default:s((()=>[u(h,{type:"primary",onClick:p.toList},{default:s((()=>[i("查看记录")])),_:1},8,["onClick"]),f("br"),u(h,{type:"warn",onClick:p.logout},{default:s((()=>[i("取消绑定")])),_:1},8,["onClick"])])),_:1},8,["title"])])),_:1})):(e(),t(k,{key:1},{default:s((()=>[u(b,{title:"您当前未绑定身份",thumbnail:"/static/warn_red.png",extra:"重要",note:"Tips"},{default:s((()=>[u(j,null,{default:s((()=>[i("如果您是学生/教职工，请输入"),u(S,{text:"学号/工号",type:"primary"})])),_:1}),f("br"),f("br"),u(j,null,{default:s((()=>[i("如果您是其他人员，请输入"),u(S,{text:"手机号",type:"warning"})])),_:1})])),_:1}),u(B,{title:"请输入学号/工号/手机号,完成身份绑定",type:"line",padding:""},{default:s((()=>[u(z,{modelValue:d.inputUsernme,"onUpdate:modelValue":n[0]||(n[0]=e=>d.inputUsernme=e),styles:d.styles,placeholder:"在这里输入学号/工号/手机号",type:"number",maxlength:"11",onConfirm:p.login},null,8,["modelValue","styles","onConfirm"]),f("br"),u(h,{class:"button",onClick:p.login,type:"primary"},{default:s((()=>[i("绑定身份")])),_:1},8,["onClick"])])),_:1})])),_:1})),u(k,null,{default:s((()=>[u(b,{title:"请注意",thumbnail:"/static/warn_green.png",extra:"建议",note:"Tips"},{default:s((()=>[u(j,null,{default:s((()=>[i("建议使用"),u(S,{text:"微信",type:"success"}),i("扫码。"),f("br"),i("如果使用浏览器，建议您关闭无痕模式，以确保您的学号/工号/手机号会被保存")])),_:1})])),_:1})])),_:1}),u(V)])),_:1})}]]);export{j as default};
